<!-- tester.html --> 
<html>
	<head>
		<title>TEST PAGE FOR CANVAs</title> 
		<script type="text/javascript" src="wbprimatives.js" >
		</script>
		<script type="text/javascript" src="../collabme_rails/app/assets/javascripts/jquery-2.0.0.min.js"> </script>
		<script type="text/javascript" src="evCanvas.js"> </script>
		<script type="text/javascript">
		/** 
		*/
		var drawables = []; 
		var cur;
		var ctx;
		var curColor = "blue";  
		function sDragFn(pos){
			cur = new Squiggle(pos.x, pos.y);
			cur.color = curColor;
			drawables.push(cur) 
		}
		var count = 0; 
		function dragFn(pos){
			cur.pts.push([pos.x, pos.y]) 
			if (count % 3 == 0 )
				redraw();
			count ++;
		}

		function eDragFn(pos){
			cur.pts.push([pos.x, pos.y])
			redraw();
		}

		function redraw(){
			for (var i = 0; i < drawables.length; i ++){
				drawables[i].draw(ctx);
			}
		} 

		var colors = ["black", "green", "blue", "red", "purple"]

		function uiColorBlock(color){
			var el = document.createElement("div")
			el.setAttribute("class", "tool_button color_option")
			el.setAttribute("color", color);
			el.innerHTML = color;
			return el; 
		}

		function uiColorPicker(){
			var el = document.createElement("div");
			el.setAttribute("class", "tool color_picker");
			for (var i = 0; i< colors.length; i ++ ){
				el.appendChild(uiColorBlock(colors[i])); 
			}
			return el; 
		}

		function uiEraser(){
			var el = document.createElement("div"); 
			el.setAttribute("class", "tool eraser")
			el.innerHTML = "erase"
			return el; 
		}

		function toolBarify(el){
			el.appendChild(uiColorPicker());
			el.appendChild(uiEraser())
		}

		$(function (){
			toolBarify($(".toolBar")[0])
			$(".color_option").click(function(){
				curColor = $(this).attr('color'); 
				$(".color_selected").removeClass("color_selected")
				$(this).addClass("color_selected")
			});
			id = "whiteBoard"
			ctx = $('#'+id)[0].getContext("2d");
			evBindCanvas(id);
			evStartDragfn(id, sDragFn)
			evDragfn(id, dragFn)
			evStopDragfn(id, eDragFn)
			
		});
		</script>
		<style type="text/css"> 
			.toolBar{
				background-color: rgb(230, 230, 230);
			}
			.tool {
				display: inline-block;
			}
			.tool_button {
				display: inline-block;
				max-width: 25px;
				max-height: 25px;
				min-width: 25px;
				min-height: 25px;
				border-width: 2px 2px 2px 2px;
				border-style: solid;
				margin: 1px;
				border-color: black;
				border-radius: 5px;
			}

			.tool_button.color_selected{
				border-color: yellow;
			}
		</style>
	</head>
	<body>
		<p>start</p>
		<hr/>
		<div class="toolBar"></div> 
		<canvas id="whiteBoard" height="500" width="1000">
		</canvas>
		<hr />
		<p>end</p>
	</body>
</html>